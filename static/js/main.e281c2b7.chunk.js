(this["webpackJsonpjwt-decoder"]=this["webpackJsonpjwt-decoder"]||[]).push([[0],{158:function(e,t){},269:function(e,t,a){e.exports=a(399)},275:function(e,t,a){},287:function(e,t){},289:function(e,t){},323:function(e,t){},325:function(e,t){},326:function(e,t){},331:function(e,t){},333:function(e,t){},353:function(e,t){},369:function(e,t){},372:function(e,t){},399:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(50),c=a.n(l),i=a(467),o=a(461),s=(a(275),a(476)),u=a(473),m=a(477),d=a(409),E=a(478),y=a(241),f=a.n(y);function p(){return n.createElement(u.a,{sx:{flexGrow:1}},n.createElement(s.a,{position:"static"},n.createElement(m.a,null,n.createElement(E.a,{size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2}},n.createElement(f.a,null)),n.createElement(d.a,{variant:"h6",component:"div",sx:{flexGrow:1}},"JWT decoder"))))}var g=a(472),b=a(466),h=a(475),w=a(479),k=a(469),v=a(480);function C(e){let{jwt:t,updateJwt:a}=e;Object(n.useEffect)(()=>{l(t)},[t]);const[r,l]=Object(n.useState)(t);return n.createElement(h.a,{container:!0,direction:"column",spacing:2},n.createElement(h.a,{item:!0},n.createElement(w.a,{fullWidth:!0,sx:{m:1},variant:"filled"},n.createElement(k.a,{sx:{color:"white"}},"JWT"),n.createElement(v.a,{id:"encoded-jwt",multiline:!0,minRows:15,value:r,onChange:e=>(t=>{l(t);try{a(t)}catch(e){console.error(e)}})(e.target.value),inputProps:{style:{color:"white"}}}))," "))}function x(e){let{decodedJwt:t,updateData:a}=e;Object(n.useEffect)(()=>{l(JSON.stringify(t.header,null,2)),i(JSON.stringify(t.payload,null,2)),s(t.signature)},[t]);const[r,l]=Object(n.useState)(JSON.stringify(t.header,null,2)),[c,i]=Object(n.useState)(JSON.stringify(t.payload,null,2)),[o,s]=Object(n.useState)(t.signature),u=(e,t,n)=>{try{t=JSON.parse(t),e=JSON.parse(e),a(e,t)}catch(r){console.error("Error updating data")}};return n.createElement(h.a,{container:!0,direction:"column",spacing:2},n.createElement(h.a,{item:!0},n.createElement(w.a,{fullWidth:!0,sx:{m:1},variant:"filled"},n.createElement(k.a,{sx:{color:"white"}},"Header"),n.createElement(v.a,{id:"header-jwt",multiline:!0,minRows:5,value:r,onChange:e=>{(t=>{l(t);try{u(t,c,o)}catch(e){console.error(e)}})(e.target.value)},inputProps:{style:{color:"white"}}}))," "),n.createElement(h.a,{item:!0},n.createElement(w.a,{fullWidth:!0,sx:{m:1},variant:"filled"},n.createElement(k.a,{sx:{color:"white"}},"Payload"),n.createElement(v.a,{id:"payload-jwt",multiline:!0,minRows:10,value:c,onChange:e=>{(t=>{i(t);try{u(r,t,o)}catch(e){console.error(e)}})(e.target.value)},inputProps:{style:{color:"white"}}}))," "),n.createElement(h.a,{item:!0},n.createElement(w.a,{fullWidth:!0,sx:{m:1},variant:"filled"},n.createElement(k.a,{sx:{color:"white"}},"Signature"),n.createElement(v.a,{id:"singature-jwt",multiline:!0,minRows:5,value:o,onChange:e=>{var t;t=e.target.value,s(t),u(r,c,t)},inputProps:{style:{color:"white"}}}))," "))}var j=a(481),W=a(460),K=a(483),S=a(463),I=a(484),A=a(470),J=a(471),O=a(485),B=a(486),N=a(474),T=a(465),P=a(487),Q=a(244),H=a.n(Q),z=a(129),F=a.n(z),G=a(247),L=a.n(G),M=a(245),U=a.n(M),R=a(246),D=a.n(R),Y=a(462);const V={kty:"RSA",kid:"default-key-id",n:"8ccB1jdKTPkOXoWI9C4hDCcSZ06b6wgHFkzW1VdTyTr8zmCuHenTpn9YLlBdyNt1BpgCppkVGsTTx_lmgWJxGjxQbONCkGaHPex7lnl2DGc9ZiGfDlHkbpCQ6gtEl8ekd5QpGswRMQySe9HDt-6GdCbvhrcD4FHv-eaWtyGfjnFWYMd7Bvh82X32wqQvJA8grkijduOPYrSUHH4vgoxWjjyfvz8MLjOi-felT2Zim2IY8rAuHxgZob2cN_dcKTrd8gHUzQJpjXaoCAsasCb_BB1xDVMekXcl_z9bWYCJMMkgTGZ1YBysBIXyQ061e80T-ycCgtLGIqZjnLTwinlbNw",e:"AQAB",use:"sig",key_ops:["verify"],alg:"RS256"},Z=a(281),X={typ:"JWT",alg:"HS512"},q={sub:"1234567890",name:"John Doe",iat:1516239022},_=(e,t,a)=>Z.sign(t,a,{header:e}),$=e=>Z.decode(e,{complete:!0}),ee=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"secret";try{return Z.verify(e,t),null}catch(a){return a}},te=(e,t)=>{try{return Z.verify(e,t,{algorithms:["RS256","RS384","RS512"]}),null}catch(a){return a}},ae=async(e,t)=>{try{const a=await ne(t);return te(e,a)}catch(a){return a}},ne=async e=>{try{const t=a(225);if("RSA"!==e.kty)throw new Error("Only RSA keys are supported");const n=e=>(e=(e=(e+"===").slice(0,e.length+e.length%4)).replace(/-/g,"+").replace(/_/g,"/"),t.util.decode64(e)),r=n(e.n),l=n(e.e),c=t.pki.rsa.setPublicKey(new t.jsbn.BigInteger(t.util.bytesToHex(r),16),new t.jsbn.BigInteger(t.util.bytesToHex(l),16));return t.pki.publicKeyToPem(c)}catch(t){throw new Error("Failed to convert JWK to PEM: "+t.message)}},re=()=>({privateKey:"-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDxxwHWN0pM+Q5e\nhYj0LiEMJxJnTpvrCAcWTNbVV1PJOvzOYK4d6dOmf1guUF3I23UGmAKmmRUaxNPH\n+WaBYnEaPFBs40KQZoc97HuWeXYMZz1mIZ8OUeRukJDqC0SXx6R3lCkazBExDJJ7\n0cO37oZ0Ju+GtwPgUe/55pa3IZ+OcVZgx3sG+HzZffbCpC8kDyCuSKN2449itJQc\nfi+CjFaOPJ+/PwwuM6L596VPZmKbYhjysC4fGBmhvZw391wpOt3yAdTNAmmNdqgI\nCxqwJv8EHXENUx6RdyX/P1tZgIkwySBMZnVgHKwEhfJDTrV7zRP7JwKC0sYipmOc\ntPCKeVs3AgMBAAECggEAD1L3hdYZSnzapH9xz70AvgSkwPfiUzVxPybKbKYAgUrQ\n04/P8vg4DV+y47SXGfAqIBHdN4v3Iqw1zbRVnLInMwXk0kUqzRY1tv7YuNykvWKD\nXLuZMwIm9VVww4GVUzCfKi9+b3YrSZP5BAoM9DwVBe88OhCgst4R1Ls0JquysW3U\nBQq8rqFdL4ntIwC66koknEkr+ZpxOL0n/r4WZeEUaGAc/gDubnMsJhmKdCdjdtib\nz32fNf91ckRP6ot5QpK4usg7jIDQkLpEmrAKLh9bT2NbN+E2u0U1DX428n7bf4g9\n6UCSOM8Nj2jPHtiVkELEapHWNWUkfWZSjSRosFwnAQKBgQD7towCeOnjFQD3wksx\nZpyVam4lkygxapKnFCiAqiVc+VFsoVO5ts+Smh0yVmQlpFaEKuFupdEzVnkv4zNN\n5vrAVaSJHkWGsRw09zTdWarwV5cxuOTzYM4zOZpXZd9P8FFF1GSM1Q3XDUqEHnb0\nTjtKrkYjarAiOh4AIOqdQb7rtwKBgQD15SQnmW5fiGqdAE54QodCCL0gmFth6i5H\n23NOYjPtZnEpTFG5kzXnJtCqQvZnbRmLCWrQdTR+eeY6eyMzRWUM8Id0fF0L++sW\nc1HEaL5O0njl2koW8gwdwllxHehrW6BOC2KW5YbQ0gJjuZl+vN094lQiQczoQolz\noHArq4gMgQKBgARuqHR6sJOhEQ1LzIsoJWW0JBBhUPndyItMnZH2bQYAFeD1zkWc\n5HbOY+k5ADZxeFyHbMTIArEGusePFp4ujQfJ+kW31L2UbMy59aJYK9xjjnP/r3hh\nof/g6cjUMGR19Nhn7wVT0xSQVVmSN8IBhqW//9grzsIrh8+0xKzUNYptAoGAH9Ic\nYKeBWgmMSm78uKFbYZdB6lLtGHm2rYPfoxggQiuMn1yKAurjAdvLCw2JV48NzClW\n0k0okulxesXuozbqwcbqsI9bdy6NmKUpwrIPVqH0FUKvbdK68Kry6imFp0b/MrpU\nctSXIrTarE8bZwRH2TdNzfUX8EKUCQuNGImlHIECgYEAvnAwQLnUAHf2/KkEKmTM\n5VMnzjgcEUkpoeUOTzWdU7bU0mHXBifrSLXZ5X8nzp8QsyOEVF8sN6bvcMkH65eM\nzakMaS07kSFAg8pnIhUXzERO6kiMrWZoEL2mA/1bzj/waZSG+Sy2/HSHWjNJ/hSQ\ntogrjNG2fRCXvEAFna+osXs=\n-----END PRIVATE KEY-----",publicKey:"-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA8ccB1jdKTPkOXoWI9C4h\nDCcSZ06b6wgHFkzW1VdTyTr8zmCuHenTpn9YLlBdyNt1BpgCppkVGsTTx/lmgWJx\nGjxQbONCkGaHPex7lnl2DGc9ZiGfDlHkbpCQ6gtEl8ekd5QpGswRMQySe9HDt+6G\ndCbvhrcD4FHv+eaWtyGfjnFWYMd7Bvh82X32wqQvJA8grkijduOPYrSUHH4vgoxW\njjyfvz8MLjOi+felT2Zim2IY8rAuHxgZob2cN/dcKTrd8gHUzQJpjXaoCAsasCb/\nBB1xDVMekXcl/z9bWYCJMMkgTGZ1YBysBIXyQ061e80T+ycCgtLGIqZjnLTwinlb\nNwIDAQAB\n-----END PUBLIC KEY-----",jwk:V});function le(e){let{children:t,value:a,index:r,...l}=e;return n.createElement("div",Object.assign({role:"tabpanel",hidden:a!==r},l),a===r&&n.createElement(u.a,{sx:{p:3}},t))}function ce(e){let{onKeyLoad:t}=e;const[r,l]=Object(n.useState)(0),[c,i]=Object(n.useState)(""),[o,s]=Object(n.useState)(""),[m,E]=Object(n.useState)(""),[y,f]=Object(n.useState)(""),[p,g]=Object(n.useState)(""),[h,w]=Object(n.useState)(""),[k,v]=Object(n.useState)(!1),C=(e,t)=>{const a=e.target.files[0];if(a){const e=new FileReader;e.onload=e=>{t(e.target.result)},e.readAsText(a)}},x=()=>{const e=re();return n.createElement(j.a,{open:k,onClose:()=>v(!1),maxWidth:"md",fullWidth:!0},n.createElement(W.a,null,"Default Application Keys"),n.createElement(K.a,null,n.createElement(u.a,{sx:{mb:3}},n.createElement(d.a,{variant:"h6",gutterBottom:!0},"Public Key (PEM format):"),n.createElement(S.a,{fullWidth:!0,multiline:!0,rows:8,variant:"outlined",value:e.publicKey,InputProps:{readOnly:!0,style:{fontFamily:"monospace",fontSize:"12px"}},sx:{mb:2}})),n.createElement(u.a,{sx:{mb:3}},n.createElement(d.a,{variant:"h6",gutterBottom:!0},"JSON Web Key (JWK format):"),n.createElement(S.a,{fullWidth:!0,multiline:!0,rows:6,variant:"outlined",value:JSON.stringify(e.jwk,null,2),InputProps:{readOnly:!0,style:{fontFamily:"monospace",fontSize:"12px"}}})),n.createElement(b.a,{severity:"warning",sx:{mt:2}},n.createElement(d.a,{variant:"body2"},n.createElement("strong",null,"Security Notice:")," These keys are for demonstration purposes only. In production, always use your own secure keys and never expose private keys."))),n.createElement(I.a,null,n.createElement(A.a,{onClick:()=>v(!1)},"Close")))};return n.createElement(n.Fragment,null,n.createElement(J.a,null,n.createElement(O.a,{expandIcon:n.createElement(H.a,null),"aria-controls":"key-loader-content",id:"key-loader-header"},n.createElement(U.a,{sx:{mr:1}}),n.createElement(d.a,{variant:"h6"},"JWT Verification Key Configuration")),n.createElement(B.a,null,n.createElement(N.a,{elevation:3,sx:{p:2}},p&&n.createElement(b.a,{severity:"error",sx:{mb:2}},p),h&&n.createElement(b.a,{severity:"success",sx:{mb:2}},h),n.createElement(u.a,{sx:{mb:2,display:"flex",gap:1}},n.createElement(A.a,{variant:"contained",color:"secondary",onClick:()=>{try{const e=re();t({type:"default",key:e.publicKey,jwk:e.jwk}),w("Default key loaded successfully"),g("")}catch(e){g(e.message||"Error loading default key")}}},"Use Default Key"),n.createElement(A.a,{variant:"outlined",startIcon:n.createElement(D.a,null),onClick:()=>{v(!0)}},"View Default Keys")),n.createElement(u.a,{sx:{borderBottom:1,borderColor:"divider"}},n.createElement(T.a,{value:r,onChange:(e,t)=>{l(t),g(""),w("")}},n.createElement(P.a,{label:"Public Key"}),n.createElement(P.a,{label:"JWK"}),n.createElement(P.a,{label:"JWKS URL"}),n.createElement(P.a,{label:"Certificate"}))),n.createElement(le,{value:r,index:0},n.createElement(d.a,{variant:"body2",sx:{mb:2}},"Enter a public key in PEM format:"),n.createElement(S.a,{fullWidth:!0,multiline:!0,rows:8,variant:"outlined",value:c,onChange:e=>i(e.target.value),placeholder:"-----BEGIN PUBLIC KEY-----\n...\n-----END PUBLIC KEY-----",sx:{mb:2}}),n.createElement(u.a,{sx:{display:"flex",gap:1}},n.createElement(A.a,{variant:"contained",component:"label",startIcon:n.createElement(F.a,null)},"Load from File",n.createElement("input",{type:"file",hidden:!0,accept:".pem,.crt,.key,.pub",onChange:e=>C(e,i)})),n.createElement(A.a,{variant:"contained",color:"primary",onClick:()=>{try{if(!c.trim())return void g("Please enter a public key");if(!c.includes("-----BEGIN PUBLIC KEY-----"))return void g("Invalid public key format");t({type:"public-key",key:c.trim()}),w("Public key loaded successfully"),g("")}catch(e){g(e.message||"Error loading public key")}}},"Load Key"))),n.createElement(le,{value:r,index:1},n.createElement(d.a,{variant:"body2",sx:{mb:2}},"Enter a JWK in JSON format:"),n.createElement(S.a,{fullWidth:!0,multiline:!0,rows:8,variant:"outlined",value:o,onChange:e=>s(e.target.value),placeholder:'{"kty": "RSA", "n": "...", "e": "AQAB", ...}',sx:{mb:2}}),n.createElement(u.a,{sx:{display:"flex",gap:1}},n.createElement(A.a,{variant:"contained",component:"label",startIcon:n.createElement(F.a,null)},"Load from File",n.createElement("input",{type:"file",hidden:!0,accept:".json,.jwk",onChange:e=>C(e,s)})),n.createElement(A.a,{variant:"contained",color:"primary",onClick:()=>{try{if(!o.trim())return void g("Please enter a JWK");const e=(e=>{try{return JSON.parse(e)}catch(p){throw new Error("Invalid JWK format")}})(o);t({type:"jwk",key:e}),w("JWK loaded successfully"),g("")}catch(e){g(e.message||"Error loading JWK")}}},"Load JWK"))),n.createElement(le,{value:r,index:2},n.createElement(d.a,{variant:"body2",sx:{mb:2}},"Enter a JWKS endpoint URL:"),n.createElement(S.a,{fullWidth:!0,variant:"outlined",value:m,onChange:e=>E(e.target.value),placeholder:"https://example.com/.well-known/jwks.json",sx:{mb:2}}),n.createElement(A.a,{variant:"contained",color:"primary",startIcon:n.createElement(L.a,null),onClick:()=>{try{if(!m.trim())return void g("Please enter a JWKS URL");if(!m.startsWith("http"))return void g("URL must start with http:// or https://");t({type:"jwks",key:m.trim()}),w("JWKS endpoint configured successfully"),g("")}catch(e){g(e.message||"Error configuring JWKS")}}},"Configure JWKS")),n.createElement(le,{value:r,index:3},n.createElement(d.a,{variant:"body2",sx:{mb:2}},"Enter an X.509 certificate in PEM format:"),n.createElement(S.a,{fullWidth:!0,multiline:!0,rows:8,variant:"outlined",value:y,onChange:e=>f(e.target.value),placeholder:"-----BEGIN CERTIFICATE-----\n...\n-----END CERTIFICATE-----",sx:{mb:2}}),n.createElement(u.a,{sx:{display:"flex",gap:1}},n.createElement(A.a,{variant:"contained",component:"label",startIcon:n.createElement(F.a,null)},"Load from File",n.createElement("input",{type:"file",hidden:!0,accept:".pem,.crt,.cer",onChange:e=>C(e,f)})),n.createElement(A.a,{variant:"contained",color:"primary",onClick:async()=>{try{if(!y.trim())return void g("Please enter a certificate");const e=(e=>{try{if(!e.includes("-----BEGIN CERTIFICATE-----"))throw new Error("Invalid certificate format");return e}catch(p){throw new Error("Invalid certificate format")}})(y),n=await(async e=>{try{const t=a(225),n=t.pki.certificateFromPem(e);return t.pki.publicKeyToPem(n.publicKey)}catch(p){throw new Error("Failed to extract public key from certificate")}})(e);t({type:"certificate",key:n,certificate:e}),w("Certificate loaded successfully"),g("")}catch(e){g(e.message||"Error loading certificate")}}},"Load Certificate")))))),n.createElement(x,null))}function ie(){const e=_(X,q,"secret"),t=$(e),[a,r]=Object(n.useState)(e),[l,c]=Object(n.useState)(t),[i,o]=Object(n.useState)(null),[s,u]=Object(n.useState)(null),m=Object(n.useCallback)(async e=>{if(i)try{let t=null;switch(i.type){case"public-key":case"certificate":case"default":t=te(e,i.key);break;case"jwk":t=await ae(e,i.key);break;case"jwks":t=await(async(e,a)=>{try{const t=(await Y.a.get(a)).data,n=Z.decode(e,{complete:!0});if(!n||!n.header)throw new Error("Invalid JWT format");const r=n.header.kid;let l=null;if(l=r?t.keys.find(e=>e.kid===r):t.keys[0],!l)throw new Error("No suitable key found in JWKS");return ae(e,l)}catch(t){return t}})(e,i.key);break;default:t=ee(e)}u(t)}catch(t){u(t)}else{const t=ee(e);u(t)}},[i]);n.useEffect(()=>{m(a)},[m,a]);const d=s?"error":"success",E=i?s?"Verification failed: ".concat(s.message):"JWT verified successfully":s?"Verification failed: ".concat(s.message):"JWT verified successfully (default secret)";return n.createElement(n.Fragment,null,n.createElement(ce,{onKeyLoad:e=>{o(e),m(a)}}),n.createElement(g.a,{sx:{width:"100%",mt:2},spacing:2},n.createElement(b.a,{severity:d},E)),n.createElement(h.a,{container:!0,spacing:2},n.createElement(h.a,{item:!0,xs:6},n.createElement(C,{spacing:2,jwt:a,updateJwt:e=>{const t=$(e);null!=t&&(r(e),c(t),m(e))}})),n.createElement(h.a,{item:!0,xs:6},n.createElement(x,{spacing:2,decodedJwt:l,updateData:(e,t)=>{const a=_(e,t,"secret"),n=$(a);r(a),c(n),m(a)}}))))}var oe=function(){return n.createElement("div",null,n.createElement(p,null),n.createElement(ie,null))},se=a(248);var ue=Object(se.a)({palette:{type:"dark",background:{default:"#303030",paper:"#C9C9C9"},primary:{main:"#3f51b5"},secondary:{main:"#f50057"}},typography:{fontSize:15,fontWeightLight:200,fontWeightRegular:300,fontFamily:"Oswald"}});c.a.render(r.a.createElement(i.a,{theme:ue},r.a.createElement(o.a,null),r.a.createElement(oe,null)),document.getElementById("root"))}},[[269,1,2]]]);
//# sourceMappingURL=main.e281c2b7.chunk.js.map